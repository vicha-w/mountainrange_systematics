# `mountainrange_systematics.py`
A quick script to generate a mountain range plot showing systematic uncertainties distribution per process, based on information of the datacard and relevant histogram ROOT files.

## Requirements
Python 3, along with the following packages, are required:
* pyROOT
* root_numpy
* numpy
* pandas

## Usage
`python3 mountainrange_systematics.py <DATA CARD PATH HERE> [--mass] [--cardname] [--ratio]`

This python script accepts and read a valid datacard that can be inputted to Higgs combine tool. It will read the path for each histogram ROOT file and read relevant histograms of each process and event category. The datacard must have a correct path to the required histogram files.

This script will combine together multiple histograms into a format called mountain range plots, where multiple histograms are displayed on the same y-axis. For now, the mountain range plot generated by this script will contain only histograms that contain matching systematic uncertainties (not labeled as `-` in the datacard).

The script has two main outputs. 
* `mountainrange_<DATACARD NAME>/` directory (or `mountainrange_ratio_<DATACARD NAME>/` if `--ratio` option is enabled) contains all histograms in PDF, PNG, and ROOT format. PDF and PNG histogram plots do not contain category labels, but ROOT file contains them. This is because labels in PDF and PNG plots can clutter very easily, but you can open the ROOT file, draw a canvas in the file (with `canvas->Draw()`) and zoom in to the relevant category. The labels displayed this way can relocate themselves once zoomed.
* `histogram_collection_<DATACARD NAME>.p` is a pickle file containing Pandas DataFrame. This DataFrame contains all histograms that is used in combine, including central histograms for all processes and histograms with uncertainties. This DataFrame can be useful in many ways, such as generating a histogram of total background against a particular uncertainty.

Several options are available:
* `--mass`: Mass parameter input for combine to be used with this card. Default value is `690`.
* `--cardname`: Datacard name. Default is `datacard`.
* `--ratio`: Generates ratio plot instead of yield plot.

## Limitations
* Only `lnN` and `shape` uncertainty type is supported.
* Only `shape *` wildcard is supported. If a particular process and event category is not listed, the script will look for lines containing `shape * <CATEGORY>`. If there are no lines matching this pattern, the script will print "Cannot resolve search result. Skipping.", and skip the category histogram altogether.